---
title: "Changepoint Detection"
author: "Hsuan Lee"
output: pdf_document
---

```{r}
library(ocp) # package for BOCD
library(changepoint) # package for PELT, BS
```

# No Changepoint REH Data

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
# Detect the CPs
BOCD_fixmw_send_ncp_param <- list()
for (i in 1:length(fixmw_send_ncp_param)) {
  BOCD_fixmw_send_ncp_param[[i]] <- onlineCPD(fixmw_send_ncp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_ncp_send <- list()
for (i in 1:length(BOCD_fixmw_send_ncp_param)) {
  locat_BOCD_ncp_send[[i]] <- BOCD_fixmw_send_ncp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_send_ncp_param)) {
  plot(BOCD_fixmw_send_ncp_param[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_diff_ncp_param <- list()
for (i in 1:length(fixmw_diff_ncp_param)) {
  BOCD_fixmw_diff_ncp_param[[i]] <- onlineCPD(fixmw_diff_ncp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_ncp_diff <- list()
for (i in 1:length(BOCD_fixmw_diff_ncp_param)) {
  locat_BOCD_ncp_diff[[i]] <- BOCD_fixmw_diff_ncp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_diff_ncp_param)) {
  plot(BOCD_fixmw_diff_ncp_param[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_ine_ncp_param <- list()
for (i in 1:length(fixmw_ine_ncp_param)) {
  BOCD_fixmw_ine_ncp_param[[i]] <- onlineCPD(fixmw_ine_ncp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_ncp_ine <- list()
for (i in 1:length(BOCD_fixmw_ine_ncp_param)) {
  locat_BOCD_ncp_ine[[i]] <- BOCD_fixmw_ine_ncp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_ine_ncp_param)) {
  plot(BOCD_fixmw_ine_ncp_param[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_out_ncp_param <- list()
for (i in 1:length(fixmw_out_ncp_param)) {
  BOCD_fixmw_out_ncp_param[[i]] <- onlineCPD(fixmw_out_ncp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_ncp_out <- list()
for (i in 1:length(BOCD_fixmw_out_ncp_param)) {
  locat_BOCD_ncp_out[[i]] <- BOCD_fixmw_out_ncp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_out_ncp_param)) {
  plot(BOCD_fixmw_out_ncp_param[[i]])
}
```

2. PELT: Exact CPs Detection Method
```{r}
# detect the changepoints
PELT_fixmw_ine_ncp_param <- list()
for (i in 1:length(fixmw_out_ncp_param)) {
  PELT_fixmw_ine_ncp_param[[i]] <- cpt.meanvar(fixmw_ine_ncp_param[[i]], method="PELT")
}

# location of the changepoints
locat_PELT_ncp_ine <- list()
for (i in 1:length(PELT_fixmw_ine_ncp_param)) {
  locat_PELT_ncp_ine[[i]] <- 
    # remove the last value of the vector, as PELT function indicates the last window as CP all the time
    PELT_fixmw_ine_ncp_param[[i]]@cpts[-length(PELT_fixmw_ine_ncp_param[[i]]@cpts)]
}







# plot the location of CPs
plot(fixmw_ine_ncp_param[[15]], type="point", col = "black")
abline(v=PELT_fixmw_ine_ncp_param[[14]]@cpts[-length(PELT_fixmw_ine_ncp_param[[15]]@cpts)], col="black")
```













































2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_ine_ncp_param <- cpt.meanvar(fixmw_ine_ncp_param, method="PELT")
summary(PELT_fixmw_ine_ncp_param)

# plot the location of CPs
plot(fixmw_ine_ncp_param, type="point", col = "red")
abline(v=PELT_fixmw_ine_ncp_param@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_ncp_param <- cpt.meanvar(fixmw_ine_ncp_param, method = "BinSeg")
cpts(BS_fixmw_ine_ncp_param)

# plot the location of CPs
plot(fixmw_ine_ncp_param, type = "l")
abline(v=BS_fixmw_ine_ncp_param@cpts[], col="red")
```















# 1 Changepoint REH Data (inertia only)

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
# Detect the CPs
BOCD_fixmw_send_1cp_param <- list()
for (i in 1:length(fixmw_send_1cp_param)) {
  BOCD_fixmw_send_1cp_param[[i]] <- onlineCPD(fixmw_send_1cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_send <- list()
for (i in 1:length(BOCD_fixmw_send_1cp_param)) {
  locat_BOCD_1cp_send[[i]] <- BOCD_fixmw_send_1cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_send_1cp_param)) {
  plot(BOCD_fixmw_send_1cp_param[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_diff_1cp_param <- list()
for (i in 1:length(fixmw_diff_1cp_param)) {
  BOCD_fixmw_diff_1cp_param[[i]] <- onlineCPD(fixmw_diff_1cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_diff <- list()
for (i in 1:length(BOCD_fixmw_diff_1cp_param)) {
  locat_BOCD_1cp_diff[[i]] <- BOCD_fixmw_diff_1cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_diff_1cp_param)) {
  plot(BOCD_fixmw_diff_1cp_param[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_ine_1cp_param <- list()
for (i in 1:length(fixmw_ine_1cp_param)) {
  BOCD_fixmw_ine_1cp_param[[i]] <- onlineCPD(fixmw_ine_1cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_ine <- list()
for (i in 1:length(BOCD_fixmw_ine_1cp_param)) {
  locat_BOCD_1cp_ine[[i]] <- BOCD_fixmw_ine_1cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_ine_1cp_param)) {
  plot(BOCD_fixmw_ine_1cp_param[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_out_1cp_param <- list()
for (i in 1:length(fixmw_out_1cp_param)) {
  BOCD_fixmw_out_1cp_param[[i]] <- onlineCPD(fixmw_out_1cp_param[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_out <- list()
for (i in 1:length(BOCD_fixmw_out_1cp_param)) {
  locat_BOCD_1cp_out[[i]] <- BOCD_fixmw_out_1cp_param[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_out_1cp_param)) {
  plot(BOCD_fixmw_out_1cp_param[[i]])
}
```












































1. BOCD: Exact CPs Detection Method
```{r}
BOCD_fixmw_send_1cp_param <- onlineCPD(fixmw_send_1cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_send_1cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_send_1cp_param)
```

```{r}
BOCD_fixmw_diff_1cp_param <- onlineCPD(fixmw_diff_1cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_diff_1cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_diff_1cp_param)
```

```{r}
BOCD_fixmw_ine_1cp_param <- onlineCPD(fixmw_ine_1cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_ine_1cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_ine_1cp_param)
```

```{r}
BOCD_fixmw_out_1cp_param <- onlineCPD(fixmw_out_1cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_out_1cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_out_1cp_param)
```

2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_send_1cp_param <- cpt.meanvar(fixmw_send_1cp_param, method="PELT")
summary(PELT_fixmw_send_1cp_param)

# plot the location of CPs
plot(fixmw_send_1cp_param, type="l", col = "red")
abline(v=PELT_fixmw_send_1cp_param@cpts[], col="black")
```

```{r}
PELT_fixmw_diff_1cp_param <- cpt.meanvar(fixmw_diff_1cp_param, method="PELT")
summary(PELT_fixmw_diff_1cp_param)

# plot the location of CPs
plot(fixmw_diff_1cp_param, type="l", col = "red")
abline(v=PELT_fixmw_diff_1cp_param@cpts[], col="black")
```

```{r}
PELT_fixmw_ine_1cp_param <- cpt.meanvar(fixmw_ine_1cp_param, method="PELT")
summary(PELT_fixmw_ine_1cp_param)

# plot the location of CPs
plot(fixmw_ine_1cp_param, type="l", col = "red")
abline(v=PELT_fixmw_ine_1cp_param@cpts[], col="black")
```

```{r}
PELT_fixmw_out_1cp_param <- cpt.meanvar(fixmw_out_1cp_param, method="PELT")
summary(PELT_fixmw_out_1cp_param)

# plot the location of CPs
plot(fixmw_out_1cp_param, type="l", col = "red")
abline(v=PELT_fixmw_out_1cp_param@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_send_1cp_param <- cpt.meanvar(fixmw_send_1cp_param, method = "BinSeg")
cpts(BS_fixmw_send_1cp_param)

# plot the location of CPs
plot(fixmw_send_1cp_param)
abline(v=BS_fixmw_send_1cp_param@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_diff_1cp_param <- cpt.meanvar(fixmw_diff_1cp_param, method = "BinSeg")
cpts(BS_fixmw_diff_1cp_param)

# plot the location of CPs
plot(fixmw_diff_1cp_param)
abline(v=BS_fixmw_diff_1cp_param@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_1cp_param <- cpt.meanvar(fixmw_ine_1cp_param, method = "BinSeg")
cpts(BS_fixmw_ine_1cp_param)

# plot the location of CPs
plot(fixmw_ine_1cp_param)
abline(v=BS_fixmw_ine_1cp_param@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_out_1cp_param <- cpt.meanvar(fixmw_out_1cp_param, method = "BinSeg")
cpts(BS_fixmw_out_1cp_param)

# plot the location of CPs
plot(fixmw_out_1cp_param)
abline(v=BS_fixmw_out_1cp_param@cpts[], col="red")
```




















# 1 Changepoint REH Data (all social interaction drivers at same locations)

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
# Detect the CPs
BOCD_fixmw_send_1cp_param_same.all <- list()
for (i in 1:length(fixmw_send_1cp_param_same.all)) {
  BOCD_fixmw_send_1cp_param_same.all[[i]] <- onlineCPD(fixmw_send_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_send_same.all <- list()
for (i in 1:length(BOCD_fixmw_send_1cp_param_same.all)) {
  locat_BOCD_1cp_send_same.all[[i]] <- BOCD_fixmw_send_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_send_1cp_param_same.all)) {
  plot(BOCD_fixmw_send_1cp_param_same.all[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_diff_1cp_param_same.all <- list()
for (i in 1:length(fixmw_diff_1cp_param_same.all)) {
  BOCD_fixmw_diff_1cp_param_same.all[[i]] <- onlineCPD(fixmw_diff_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_diff_same.all <- list()
for (i in 1:length(BOCD_fixmw_diff_1cp_param_same.all)) {
  locat_BOCD_1cp_diff_same.all[[i]] <- BOCD_fixmw_diff_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_diff_1cp_param_same.all)) {
  plot(BOCD_fixmw_diff_1cp_param_same.all[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_ine_1cp_param_same.all <- list()
for (i in 1:length(fixmw_ine_1cp_param_same.all)) {
  BOCD_fixmw_ine_1cp_param_same.all[[i]] <- onlineCPD(fixmw_ine_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_ine_same.all <- list()
for (i in 1:length(BOCD_fixmw_ine_1cp_param_same.all)) {
  locat_BOCD_1cp_ine_same.all[[i]] <- BOCD_fixmw_ine_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_ine_1cp_param_same.all)) {
  plot(BOCD_fixmw_ine_1cp_param_same.all[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_out_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  BOCD_fixmw_out_1cp_param_same.all[[i]] <- onlineCPD(fixmw_out_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_out_same.all <- list()
for (i in 1:length(BOCD_fixmw_out_1cp_param_same.all)) {
  locat_BOCD_1cp_out_same.all[[i]] <- BOCD_fixmw_out_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_out_1cp_param_same.all)) {
  plot(BOCD_fixmw_out_1cp_param_same.all[[i]])
}
```


































**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
BOCD_fixmw_send_1cp_param_same.all <- onlineCPD(fixmw_send_1cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_send_1cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_send_1cp_param_same.all)
```

```{r}
BOCD_fixmw_diff_1cp_param_same.all <- onlineCPD(fixmw_diff_1cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_diff_1cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_diff_1cp_param_same.all)
```

```{r}
BOCD_fixmw_ine_1cp_param_same.all <- onlineCPD(fixmw_ine_1cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_ine_1cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_ine_1cp_param_same.all)
```

```{r}
BOCD_fixmw_out_1cp_param_same.all <- onlineCPD(fixmw_out_1cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_out_1cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_out_1cp_param_same.all)
```

2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_send_1cp_param_same.all <- cpt.meanvar(fixmw_send_1cp_param_same.all, method="PELT")
summary(PELT_fixmw_send_1cp_param_same.all)

# plot the location of CPs
plot(fixmw_send_1cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_send_1cp_param_same.all@cpts[], col="black")
```

```{r}
PELT_fixmw_diff_1cp_param_same.all <- cpt.meanvar(fixmw_diff_1cp_param_same.all, method="PELT")
summary(PELT_fixmw_diff_1cp_param_same.all)

# plot the location of CPs
plot(fixmw_diff_1cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_diff_1cp_param_same.all@cpts[], col="black")
```

```{r}
PELT_fixmw_ine_1cp_param_same.all <- cpt.meanvar(fixmw_ine_1cp_param_same.all, method="PELT")
summary(PELT_fixmw_ine_1cp_param_same.all)

# plot the location of CPs
plot(fixmw_ine_1cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_ine_1cp_param_same.all@cpts[], col="black")
```

```{r}
PELT_fixmw_out_1cp_param_same.all <- cpt.meanvar(fixmw_out_1cp_param_same.all, method="PELT")
summary(PELT_fixmw_out_1cp_param_same.all)

# plot the location of CPs
plot(fixmw_out_1cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_out_1cp_param_same.all@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_send_1cp_param_same.all <- cpt.meanvar(fixmw_send_1cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_send_1cp_param_same.all)

# plot the location of CPs
plot(fixmw_send_1cp_param_same.all)
abline(v=BS_fixmw_send_1cp_param_same.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_diff_1cp_param_same.all <- cpt.meanvar(fixmw_diff_1cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_diff_1cp_param_same.all)

# plot the location of CPs
plot(fixmw_diff_1cp_param_same.all)
abline(v=BS_fixmw_diff_1cp_param_same.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_1cp_param_same.all <- cpt.meanvar(fixmw_ine_1cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_ine_1cp_param_same.all)

# plot the location of CPs
plot(fixmw_ine_1cp_param_same.all)
abline(v=BS_fixmw_ine_1cp_param_same.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_out_1cp_param_same.all <- cpt.meanvar(fixmw_out_1cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_out_1cp_param_same.all)

# plot the location of CPs
plot(fixmw_out_1cp_param_same.all)
abline(v=BS_fixmw_out_1cp_param_same.all@cpts[], col="red")
```




























# 1 Changepoint REH Data (all social interaction driver at different locations)

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
# Detect the CPs
BOCD_fixmw_send_1cp_param_same.all <- list()
for (i in 1:length(fixmw_send_1cp_param_same.all)) {
  BOCD_fixmw_send_1cp_param_same.all[[i]] <- onlineCPD(fixmw_send_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_send_same.all <- list()
for (i in 1:length(BOCD_fixmw_send_1cp_param_same.all)) {
  locat_BOCD_1cp_send_same.all[[i]] <- BOCD_fixmw_send_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_send_1cp_param_same.all)) {
  plot(BOCD_fixmw_send_1cp_param_same.all[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_diff_1cp_param_same.all <- list()
for (i in 1:length(fixmw_diff_1cp_param_same.all)) {
  BOCD_fixmw_diff_1cp_param_same.all[[i]] <- onlineCPD(fixmw_diff_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_diff_same.all <- list()
for (i in 1:length(BOCD_fixmw_diff_1cp_param_same.all)) {
  locat_BOCD_1cp_diff_same.all[[i]] <- BOCD_fixmw_diff_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_diff_1cp_param_same.all)) {
  plot(BOCD_fixmw_diff_1cp_param_same.all[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_ine_1cp_param_same.all <- list()
for (i in 1:length(fixmw_ine_1cp_param_same.all)) {
  BOCD_fixmw_ine_1cp_param_same.all[[i]] <- onlineCPD(fixmw_ine_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_ine_same.all <- list()
for (i in 1:length(BOCD_fixmw_ine_1cp_param_same.all)) {
  locat_BOCD_1cp_ine_same.all[[i]] <- BOCD_fixmw_ine_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_ine_1cp_param_same.all)) {
  plot(BOCD_fixmw_ine_1cp_param_same.all[[i]])
}
```

```{r}
# Detect the CPs
BOCD_fixmw_out_1cp_param_same.all <- list()
for (i in 1:length(fixmw_out_1cp_param_same.all)) {
  BOCD_fixmw_out_1cp_param_same.all[[i]] <- onlineCPD(fixmw_out_1cp_param_same.all[[i]], 
                                            getR = T, 
                                            optionalOutputs = T, 
                                            truncRlim = 10^-4)
}

# location of the CPs
locat_BOCD_1cp_out_same.all <- list()
for (i in 1:length(BOCD_fixmw_out_1cp_param_same.all)) {
  locat_BOCD_1cp_out_same.all[[i]] <- BOCD_fixmw_out_1cp_param_same.all[[i]][["changepoint_lists"]][["maxCPs"]][[1]]
}

# plot the CPs for each iteration
for (i in 1:length(BOCD_fixmw_out_1cp_param_same.all)) {
  plot(BOCD_fixmw_out_1cp_param_same.all[[i]])
}
```



































1. BOCD: Exact CPs Detection Method
```{r}
BOCD_fixmw_send_1cp_param_diff.all <- onlineCPD(fixmw_send_1cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_send_1cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_send_1cp_param_diff.all)
```

```{r}
BOCD_fixmw_diff_1cp_param_diff.all <- onlineCPD(fixmw_diff_1cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_diff_1cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_diff_1cp_param_diff.all)
```

```{r}
BOCD_fixmw_ine_1cp_param_diff.all <- onlineCPD(fixmw_ine_1cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_ine_1cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_ine_1cp_param_diff.all)
```

```{r}
BOCD_fixmw_out_1cp_param_diff.all <- onlineCPD(fixmw_out_1cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_out_1cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_out_1cp_param_diff.all)
```

2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_send_1cp_param_diff.all <- cpt.var(fixmw_send_1cp_param_diff.all, method="PELT")
summary(PELT_fixmw_send_1cp_param_diff.all)

# plot the location of CPs
plot(fixmw_send_1cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_send_1cp_param_diff.all@cpts[], col="black")
```

```{r}
PELT_fixmw_diff_1cp_param_diff.all <- cpt.var(fixmw_diff_1cp_param_diff.all, method="PELT")
summary(PELT_fixmw_diff_1cp_param_diff.all)

# plot the location of CPs
plot(fixmw_diff_1cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_diff_1cp_param_diff.all@cpts[], col="black")
```

```{r}
PELT_fixmw_ine_1cp_param_diff.all <- cpt.var(fixmw_ine_1cp_param_diff.all, method="PELT")
summary(PELT_fixmw_ine_1cp_param_diff.all)

# plot the location of CPs
plot(fixmw_ine_1cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_ine_1cp_param_diff.all@cpts[], col="black")
```

```{r}
PELT_fixmw_out_1cp_param_diff.all <- cpt.var(fixmw_out_1cp_param_diff.all, method="PELT")
summary(PELT_fixmw_out_1cp_param_diff.all)

# plot the location of CPs
plot(fixmw_out_1cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_out_1cp_param_diff.all@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_send_1cp_param_diff.all <- cpt.meanvar(fixmw_send_1cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_send_1cp_param_diff.all)

# plot the location of CPs
plot(fixmw_send_1cp_param_diff.all)
abline(v=BS_fixmw_send_1cp_param_diff.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_diff_1cp_param_diff.all <- cpt.meanvar(fixmw_diff_1cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_diff_1cp_param_diff.all)

# plot the location of CPs
plot(fixmw_diff_1cp_param_diff.all)
abline(v=BS_fixmw_diff_1cp_param_diff.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_1cp_param_diff.all <- cpt.meanvar(fixmw_ine_1cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_ine_1cp_param_diff.all)

# plot the location of CPs
plot(fixmw_ine_1cp_param_diff.all)
abline(v=BS_fixmw_ine_1cp_param_diff.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_out_1cp_param_diff.all <- cpt.meanvar(fixmw_out_1cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_out_1cp_param_diff.all)

# plot the location of CPs
plot(fixmw_out_1cp_param_diff.all)
abline(v=BS_fixmw_out_1cp_param_diff.all@cpts[], col="red")
```

# 2 Changepoints REH Data (inertia only)

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
BOCD_fixmw_send_2cp_param <- onlineCPD(fixmw_send_2cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_send_2cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_send_2cp_param)
```

```{r}
BOCD_fixmw_diff_2cp_param <- onlineCPD(fixmw_diff_2cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_diff_2cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_diff_2cp_param)
```

```{r}
BOCD_fixmw_ine_2cp_param <- onlineCPD(fixmw_ine_2cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_ine_2cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_ine_2cp_param)
```

```{r}
BOCD_fixmw_out_2cp_param <- onlineCPD(fixmw_out_2cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_out_2cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_out_2cp_param)
```

2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_send_2cp_param <- cpt.var(fixmw_send_2cp_param, method="PELT")
summary(PELT_fixmw_send_2cp_param)

# plot the location of CPs
plot(fixmw_send_2cp_param, type="l", col = "red")
abline(v=PELT_fixmw_send_2cp_param@cpts[], col="black")
```

```{r}
PELT_fixmw_diff_2cp_param <- cpt.var(fixmw_diff_2cp_param, method="PELT")
summary(PELT_fixmw_diff_2cp_param)

# plot the location of CPs
plot(fixmw_diff_2cp_param, type="l", col = "red")
abline(v=PELT_fixmw_diff_2cp_param@cpts[], col="black")
```

```{r}
PELT_fixmw_ine_2cp_param <- cpt.meanvar(fixmw_ine_2cp_param, method="PELT")
summary(PELT_fixmw_ine_2cp_param)

# plot the location of CPs
plot(fixmw_ine_2cp_param, type="l", col = "red")
abline(v=PELT_fixmw_ine_2cp_param@cpts[], col="black")
```

```{r}
PELT_fixmw_out_2cp_param <- cpt.var(fixmw_out_2cp_param, method="PELT")
summary(PELT_fixmw_out_2cp_param)

# plot the location of CPs
plot(fixmw_out_2cp_param, type="l", col = "red")
abline(v=PELT_fixmw_out_2cp_param@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_send_2cp_param <- cpt.var(fixmw_send_2cp_param, method = "BinSeg")
cpts(BS_fixmw_send_2cp_param)

# plot the location of CPs
plot(fixmw_send_2cp_param)
abline(v=BS_fixmw_send_2cp_param@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_diff_2cp_param <- cpt.var(fixmw_diff_2cp_param, method = "BinSeg")
cpts(BS_fixmw_diff_2cp_param)

# plot the location of CPs
plot(fixmw_diff_2cp_param)
abline(v=BS_fixmw_diff_2cp_param@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_2cp_param <- cpt.var(fixmw_ine_2cp_param, method = "BinSeg")
cpts(BS_fixmw_ine_2cp_param)

# plot the location of CPs
plot(fixmw_ine_2cp_param)
abline(v=BS_fixmw_ine_2cp_param@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_out_2cp_param <- cpt.var(fixmw_out_2cp_param, method = "BinSeg")
cpts(BS_fixmw_out_2cp_param)

# plot the location of CPs
plot(fixmw_out_2cp_param)
abline(v=BS_fixmw_out_2cp_param@cpts[], col="red")
```

# 2 Changepoints REH Data (all social interaction drivers at same locations)

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
BOCD_fixmw_send_2cp_param_same.all <- onlineCPD(fixmw_send_2cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_send_2cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_send_2cp_param_same.all)
```

```{r}
BOCD_fixmw_diff_2cp_param_same.all <- onlineCPD(fixmw_diff_2cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_diff_2cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_diff_2cp_param_same.all)
```

```{r}
BOCD_fixmw_ine_2cp_param_same.all <- onlineCPD(fixmw_ine_2cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_ine_2cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_ine_2cp_param_same.all)
```

```{r}
BOCD_fixmw_out_2cp_param_same.all <- onlineCPD(fixmw_out_2cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_out_2cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_out_2cp_param_same.all)
```

2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_send_2cp_param_same.all <- cpt.meanvar(fixmw_send_2cp_param_same.all, method="PELT")
summary(PELT_fixmw_send_2cp_param_same.all)

# plot the location of CPs
plot(fixmw_send_2cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_send_2cp_param_same.all@cpts[], col="black")
```

```{r}
PELT_fixmw_diff_2cp_param_same.all <- cpt.meanvar(fixmw_diff_2cp_param_same.all, method="PELT")
summary(PELT_fixmw_diff_2cp_param_same.all)

# plot the location of CPs
plot(fixmw_diff_2cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_diff_2cp_param_same.all@cpts[], col="black")
```

```{r}
PELT_fixmw_ine_2cp_param_same.all <- cpt.meanvar(fixmw_ine_2cp_param_same.all, method="PELT")
summary(PELT_fixmw_ine_2cp_param_same.all)

# plot the location of CPs
plot(fixmw_ine_2cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_ine_2cp_param_same.all@cpts[], col="black")
```

```{r}
PELT_fixmw_out_2cp_param_same.all <- cpt.meanvar(fixmw_out_2cp_param_same.all, method="PELT")
summary(PELT_fixmw_out_2cp_param_same.all)

# plot the location of CPs
plot(fixmw_out_2cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_out_2cp_param_same.all@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_send_2cp_param_same.all <- cpt.meanvar(fixmw_send_2cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_send_2cp_param_same.all)

# plot the location of CPs
plot(fixmw_send_2cp_param_same.all)
abline(v=BS_fixmw_send_2cp_param_same.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_diff_2cp_param_same.all <- cpt.meanvar(fixmw_diff_2cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_diff_2cp_param_same.all)

# plot the location of CPs
plot(fixmw_diff_2cp_param_same.all)
abline(v=BS_fixmw_diff_2cp_param_same.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_2cp_param_same.all <- cpt.meanvar(fixmw_ine_2cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_ine_2cp_param_same.all)

# plot the location of CPs
plot(fixmw_ine_2cp_param_same.all)
abline(v=BS_fixmw_ine_2cp_param_same.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_out_2cp_param_same.all <- cpt.meanvar(fixmw_out_2cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_out_2cp_param_same.all)

# plot the location of CPs
plot(fixmw_out_2cp_param_same.all)
abline(v=BS_fixmw_out_2cp_param_same.all@cpts[], col="red")
```

# 2 Changepoints REH Data (all social interaction driver at different locations)

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
BOCD_fixmw_send_2cp_param_diff.all <- onlineCPD(fixmw_send_2cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_send_2cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_send_2cp_param_diff.all)
```

```{r}
BOCD_fixmw_diff_2cp_param_diff.all <- onlineCPD(fixmw_diff_2cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_diff_2cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_diff_2cp_param_diff.all)
```

```{r}
BOCD_fixmw_ine_2cp_param_diff.all <- onlineCPD(fixmw_ine_2cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_ine_2cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_ine_2cp_param_diff.all)
```

```{r}
BOCD_fixmw_out_2cp_param_diff.all <- onlineCPD(fixmw_out_2cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_out_2cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_out_2cp_param_diff.all)
```

2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_send_2cp_param_diff.all <- cpt.meanvar(fixmw_send_2cp_param_diff.all, method="PELT")
summary(PELT_fixmw_send_2cp_param_diff.all)

# plot the location of CPs
plot(fixmw_send_2cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_send_2cp_param_diff.all@cpts[], col="black")
```

```{r}
PELT_fixmw_diff_2cp_param_diff.all <- cpt.meanvar(fixmw_diff_2cp_param_diff.all, method="PELT")
summary(PELT_fixmw_diff_2cp_param_diff.all)

# plot the location of CPs
plot(fixmw_diff_2cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_diff_2cp_param_diff.all@cpts[], col="black")
```

```{r}
PELT_fixmw_ine_2cp_param_diff.all <- cpt.meanvar(fixmw_ine_2cp_param_diff.all, method="PELT")
summary(PELT_fixmw_ine_2cp_param_diff.all)

# plot the location of CPs
plot(fixmw_ine_2cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_ine_2cp_param_diff.all@cpts[], col="black")
```

```{r}
PELT_fixmw_out_2cp_param_diff.all <- cpt.meanvar(fixmw_out_2cp_param_diff.all, method="PELT")
summary(PELT_fixmw_out_2cp_param_diff.all)

# plot the location of CPs
plot(fixmw_out_2cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_out_2cp_param_diff.all@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_send_2cp_param_diff.all <- cpt.meanvar(fixmw_send_2cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_send_2cp_param_diff.all)

# plot the location of CPs
plot(fixmw_send_2cp_param_diff.all)
abline(v=BS_fixmw_send_2cp_param_diff.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_diff_2cp_param_diff.all <- cpt.meanvar(fixmw_diff_2cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_diff_2cp_param_diff.all)

# plot the location of CPs
plot(fixmw_diff_2cp_param_diff.all)
abline(v=BS_fixmw_diff_2cp_param_diff.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_2cp_param_diff.all <- cpt.meanvar(fixmw_ine_2cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_ine_2cp_param_diff.all)

# plot the location of CPs
plot(fixmw_ine_2cp_param_diff.all)
abline(v=BS_fixmw_ine_2cp_param_diff.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_out_2cp_param_diff.all <- cpt.meanvar(fixmw_out_2cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_out_2cp_param_diff.all)

# plot the location of CPs
plot(fixmw_out_2cp_param_diff.all)
abline(v=BS_fixmw_out_2cp_param_diff.all@cpts[], col="red")
```

# 3 Changepoints REH Data (inertia only)

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
BOCD_fixmw_send_3cp_param <- onlineCPD(fixmw_send_3cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_send_3cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_send_3cp_param)
```

```{r}
BOCD_fixmw_diff_3cp_param <- onlineCPD(fixmw_diff_3cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_diff_3cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_diff_3cp_param)
```

```{r}
BOCD_fixmw_ine_3cp_param <- onlineCPD(fixmw_ine_3cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_ine_3cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_ine_3cp_param)
```

```{r}
BOCD_fixmw_out_3cp_param <- onlineCPD(fixmw_out_3cp_param, getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_out_3cp_param[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_out_3cp_param)
```

2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_send_3cp_param <- cpt.var(fixmw_send_3cp_param, method="PELT")
summary(PELT_fixmw_send_3cp_param)

# plot the location of CPs
plot(fixmw_send_3cp_param, type="l", col = "red")
abline(v=PELT_fixmw_send_3cp_param@cpts[], col="black")
```

```{r}
PELT_fixmw_diff_3cp_param <- cpt.var(fixmw_diff_3cp_param, method="PELT")
summary(PELT_fixmw_diff_3cp_param)

# plot the location of CPs
plot(fixmw_diff_3cp_param, type="l", col = "red")
abline(v=PELT_fixmw_diff_3cp_param@cpts[], col="black")
```

```{r}
PELT_fixmw_ine_3cp_param <- cpt.var(fixmw_ine_3cp_param, method="PELT")
summary(PELT_fixmw_ine_3cp_param)

# plot the location of CPs
plot(fixmw_ine_3cp_param, type="l", col = "red")
abline(v=PELT_fixmw_ine_3cp_param@cpts[], col="black")
```

```{r}
PELT_fixmw_out_3cp_param <- cpt.var(fixmw_out_3cp_param, method="PELT")
summary(PELT_fixmw_out_3cp_param)

# plot the location of CPs
plot(fixmw_out_3cp_param, type="l", col = "red")
abline(v=PELT_fixmw_out_3cp_param@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_send_3cp_param <- cpt.var(fixmw_send_3cp_param, method = "BinSeg")
cpts(BS_fixmw_send_3cp_param)

# plot the location of CPs
plot(fixmw_send_3cp_param)
abline(v=BS_fixmw_send_3cp_param@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_diff_3cp_param <- cpt.var(fixmw_diff_3cp_param, method = "BinSeg")
cpts(BS_fixmw_diff_3cp_param)

# plot the location of CPs
plot(fixmw_diff_3cp_param)
abline(v=BS_fixmw_diff_3cp_param@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_3cp_param <- cpt.var(fixmw_ine_3cp_param, method = "BinSeg")
cpts(BS_fixmw_ine_3cp_param)

# plot the location of CPs
plot(fixmw_ine_3cp_param)
abline(v=BS_fixmw_ine_3cp_param@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_out_3cp_param <- cpt.var(fixmw_out_3cp_param, method = "BinSeg")
cpts(BS_fixmw_out_3cp_param)

# plot the location of CPs
plot(fixmw_out_3cp_param)
abline(v=BS_fixmw_out_3cp_param@cpts[], col="red")
```

# 3 Changepoints REH Data (all social interaction drivers at same locations)

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
BOCD_fixmw_send_3cp_param_same.all <- onlineCPD(fixmw_send_3cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_send_3cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_send_3cp_param_same.all)
```

```{r}
BOCD_fixmw_diff_3cp_param_same.all <- onlineCPD(fixmw_diff_3cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_diff_3cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_diff_3cp_param_same.all)
```

```{r}
BOCD_fixmw_ine_3cp_param_same.all <- onlineCPD(fixmw_ine_3cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_ine_3cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_ine_3cp_param_same.all)
```

```{r}
BOCD_fixmw_out_3cp_param_same.all <- onlineCPD(fixmw_out_3cp_param_same.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_out_3cp_param_same.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_out_3cp_param_same.all)
```

2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_send_3cp_param_same.all <- cpt.meanvar(fixmw_send_3cp_param_same.all, method="PELT")
summary(PELT_fixmw_send_3cp_param_same.all)

# plot the location of CPs
plot(fixmw_send_3cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_send_3cp_param_same.all@cpts[], col="black")
```

```{r}
PELT_fixmw_diff_3cp_param_same.all <- cpt.meanvar(fixmw_diff_3cp_param_same.all, method="PELT")
summary(PELT_fixmw_diff_3cp_param_same.all)

# plot the location of CPs
plot(fixmw_diff_3cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_diff_3cp_param_same.all@cpts[], col="black")
```

```{r}
PELT_fixmw_ine_3cp_param_same.all <- cpt.meanvar(fixmw_ine_3cp_param_same.all, method="PELT")
summary(PELT_fixmw_ine_3cp_param_same.all)

# plot the location of CPs
plot(fixmw_ine_3cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_ine_3cp_param_same.all@cpts[], col="black")
```

```{r}
PELT_fixmw_out_3cp_param_same.all <- cpt.meanvar(fixmw_out_3cp_param_same.all, method="PELT")
summary(PELT_fixmw_out_3cp_param_same.all)

# plot the location of CPs
plot(fixmw_out_3cp_param_same.all, type="l", col = "red")
abline(v=PELT_fixmw_out_3cp_param_same.all@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_send_3cp_param_same.all <- cpt.meanvar(fixmw_send_3cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_send_3cp_param_same.all)

# plot the location of CPs
plot(fixmw_send_3cp_param_same.all)
abline(v=BS_fixmw_send_3cp_param_same.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_diff_3cp_param_same.all <- cpt.meanvar(fixmw_diff_3cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_diff_3cp_param_same.all)

# plot the location of CPs
plot(fixmw_diff_3cp_param_same.all)
abline(v=BS_fixmw_diff_3cp_param_same.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_3cp_param_same.all <- cpt.meanvar(fixmw_ine_3cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_ine_3cp_param_same.all)

# plot the location of CPs
plot(fixmw_ine_3cp_param_same.all)
abline(v=BS_fixmw_ine_3cp_param_same.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_out_3cp_param_same.all <- cpt.meanvar(fixmw_out_3cp_param_same.all, method = "BinSeg")
cpts(BS_fixmw_out_3cp_param_same.all)

# plot the location of CPs
plot(fixmw_out_3cp_param_same.all)
abline(v=BS_fixmw_out_3cp_param_same.all@cpts[], col="red")
```

# 3 Changepoints REH Data (all social interaction driver at different locations)

**Test CPs of the Fixed MW parameters**

1. BOCD: Exact CPs Detection Method
```{r}
BOCD_fixmw_send_3cp_param_diff.all <- onlineCPD(fixmw_send_3cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_send_3cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_send_3cp_param_diff.all)
```

```{r}
BOCD_fixmw_diff_3cp_param_diff.all <- onlineCPD(fixmw_diff_3cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_diff_3cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_diff_3cp_param_diff.all)
```

```{r}
BOCD_fixmw_ine_3cp_param_diff.all <- onlineCPD(fixmw_ine_3cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_ine_3cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_ine_3cp_param_diff.all)
```

```{r}
BOCD_fixmw_out_3cp_param_diff.all <- onlineCPD(fixmw_out_3cp_param_diff.all, 
                                               getR = T, optionalOutputs = T, truncRlim = 10^-4)
BOCD_fixmw_out_3cp_param_diff.all[["changepoint_lists"]][["maxCPs"]][[1]]
plot(BOCD_fixmw_out_3cp_param_diff.all)
```

2. PELT: Exact CPs Detection Method
```{r}
PELT_fixmw_send_3cp_param_diff.all <- cpt.meanvar(fixmw_send_3cp_param_diff.all, method="PELT")
summary(PELT_fixmw_send_3cp_param_diff.all)

# plot the location of CPs
plot(fixmw_send_3cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_send_3cp_param_diff.all@cpts[], col="black")
```

```{r}
PELT_fixmw_diff_3cp_param_diff.all <- cpt.meanvar(fixmw_diff_3cp_param_diff.all, method="PELT")
summary(PELT_fixmw_diff_3cp_param_diff.all)

# plot the location of CPs
plot(fixmw_diff_3cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_diff_3cp_param_diff.all@cpts[], col="black")
```

```{r}
PELT_fixmw_ine_3cp_param_diff.all <- cpt.meanvar(fixmw_ine_3cp_param_diff.all, method="PELT")
summary(PELT_fixmw_ine_3cp_param_diff.all)

# plot the location of CPs
plot(fixmw_ine_3cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_ine_3cp_param_diff.all@cpts[], col="black")
```

```{r}
PELT_fixmw_out_3cp_param_diff.all <- cpt.meanvar(fixmw_out_3cp_param_diff.all, method="PELT")
summary(PELT_fixmw_out_3cp_param_diff.all)

# plot the location of CPs
plot(fixmw_out_3cp_param_diff.all, type="l", col = "red")
abline(v=PELT_fixmw_out_3cp_param_diff.all@cpts[], col="black")
```

3. BS: approximate CPs Detection Method
```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_send_3cp_param_diff.all <- cpt.meanvar(fixmw_send_3cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_send_3cp_param_diff.all)

# plot the location of CPs
plot(fixmw_send_3cp_param_diff.all)
abline(v=BS_fixmw_send_3cp_param_diff.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_diff_3cp_param_diff.all <- cpt.meanvar(fixmw_diff_3cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_diff_3cp_param_diff.all)

# plot the location of CPs
plot(fixmw_diff_3cp_param_diff.all)
abline(v=BS_fixmw_diff_3cp_param_diff.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_ine_3cp_param_diff.all <- cpt.meanvar(fixmw_ine_3cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_ine_3cp_param_diff.all)

# plot the location of CPs
plot(fixmw_ine_3cp_param_diff.all)
abline(v=BS_fixmw_ine_3cp_param_diff.all@cpts[], col="red")
```

```{r}
# cpt.meanvar -> find changes in both mean and variance for data
BS_fixmw_out_3cp_param_diff.all <- cpt.meanvar(fixmw_out_3cp_param_diff.all, method = "BinSeg")
cpts(BS_fixmw_out_3cp_param_diff.all)

# plot the location of CPs
plot(fixmw_out_3cp_param_diff.all)
abline(v=BS_fixmw_out_3cp_param_diff.all@cpts[], col="red")
```
