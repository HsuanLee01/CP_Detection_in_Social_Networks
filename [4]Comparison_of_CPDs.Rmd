---
title: "Comparison of CPDs"
author: "Hsuan Lee"
output: pdf_document
---
```{r}
# install.packages('caret')
library(caret) # for confusion matrix
```

# Confusion Matrix, and F1 score

```{r}
# rep = number of datasets we have
rep <- 15
```

**For the datasets with no changepoints**

Reference:
```{r}
# number of windows of each dataset
length_ncp <- list()
for (i in 1:rep) {
  length_ncp[[i]] <- length(fixmw_send_ncp_param[[i]])
}

# create the true changepoints locations
ref_ncp <- list()
for (i in 1:rep) {
  ref_ncp[[i]] <- rep(0, length_ncp[[i]])
}
```

Prediction:

1. BOCPD

- Sender Effect
```{r}
pred_send_BOCD_ncp <- list()
for (i in 1:rep) {
  # remove the first value of the vector, as BOCPD function indicates the first window as CP all the time
  locat_cp <- locat_BOCD_ncp_send[[i]][-1]
  pred_send_BOCD_ncp[[i]] <- rep(0, length_ncp[[i]])
  pred_send_BOCD_ncp[[i]][c(locat_cp)] <- 1 ### still need to fix it 
}
```


















# Create the function for MSE
```{r}
MSE_CPD <- function(pred_CPs, actu_CPs){
  
  single_MSE <- 0 # create an blank vector for storing
  
  for (CP in 1:length(pred_CPs)) {
    # MSE of each CP
    single_MSE[CP] <- (pred_CPs[CP] - actu_CPs[CP])^2
    }
  
  # sum the MSE from each CP
  sum_MSE <- sum(single_MSE)
  
  # MSE
  MSE <- sum_MSE / length(pred_CPs)
  
  return(MSE)
}
```

# Create the function for MSD
```{r}
MSD_CPD <- function(pred_CPs, actu_CPs){
  
  single_MSD <- 0 # create an blank vector for storing
  
  for (CP in 1:length(pred_CPs)) {
    # MSD of each CP
    single_MSD[CP] <- pred_CPs[CP] - actu_CPs[CP]
    }
  
  # sum the MSD from each CP
  sum_MSD <- sum(single_MSD)
  
  # MSD
  MSD <- sum_MSD / length(pred_CPs)
  
  return(MSD)
}
```
































